---
title: 1_Electron基本介绍
categories: Electron
tags: Electron
date: 2024-01-10 09:47:00
---

# Electron基本介绍

## 1 创建你的应用程序
### 1.1 使用脚手架创建
```bash
mkdir my-electron-app && cd my-electron-app
npm init
```
**你的 package.json 文件应该像这样：**
```bash
{
  "name": "my-electron-app",
  "version": "1.0.0",
  "description": "Hello World!",
  "main": "index.js",
  "author": "Jane Doe",
  "license": "MIT"
}
```
**然后，将 electron 包安装到应用的开发依赖中。**
```bash
npm install --save-dev electron
```

最后，您希望能够执行 Electron 如下所示，在您的 package.json配置文件中的scripts字段下增加一条start命令：

```bash
{
  "scripts": {
    "start": "electron ."
  }
}
```

### 1.2 创建页面
创建index.html
```bash
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'">
    <title>Hello World!</title>
  </head>
  <body>
    <h1>Hello World!</h1>
    We are using Node.js <span id="node-version"></span>,
    Chromium <span id="chrome-version"></span>,
    and Electron <span id="electron-version"></span>.
  </body>
</html>
```

### 1.3 在窗口中打开您的页面
创建index.js
```bash
const {app, BrowserWindow} = require('electron');

// 创建窗口
const createWindow = () => {
    const win = new BrowserWindow({ 
        width: 800,
        height: 600
    })
    // 加载文件
    win.loadFile('index.html')
}

// whenReady生命周期方法，会在electron完成应用初始化后调用
// 返回一个promise
app.whenReady().then(() => {
    createWindow()
})

```

## 2.进程与线程
### 2.1 什么是进程？
假设我们电脑看作一个工厂，电脑上面可以运行应用程序（浏览器，word,音乐播放器，视频播放器），每个应用程序都可以看作独立的工作区域，这个独立的工作区域就是我们的进程。
每个进程都会有独立的内存空间和系统资源，每个进程之间是独立的，这意味没有一个进程的崩溃，影响其他进程

### 2.2 什么是线程
刚才我们将进程比作工厂里面一个独立的工作区域，那么每个工作区域都会有员工，一个独立的工作区域是可以有多个员工的，类似的，**一个进程也可以有多个线程**，线程之间进行协同工作，共享相同的**数据和资源**，线程是操作系统所能调度的最小单位
<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2023-12-14-021232.png" alt="image-20231214101232495" style="zoom:40%;" />
同样都是线程，其中一条线程能够创建其他6个线程，并且又决定这些线程都能够做什么的能力，那么这些线程就被称为主线程。
在一个进程中所拥有的资源，所有的线程都有权利去使用，这个就叫做“进程资源共享”

理论上来讲，一个应用对应一个进程，但是这并不是绝对的，一些大型应用，在进行架构的深海，会设计为多个进程应用，比较典型的就是Chrome浏览器，一个标签页对应一个进程
这样的应用我们称为“多进程应用”，如下图所示

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2023-12-14-021631.png" alt="image-20231214101630565" style="zoom:50%;" />

  Electron 是主进程，对应的就是我们应用入口文件的 index.js，该主进程负责的任务有：

- 管理整个 Electron 应用程序的生命周期
- 访问文件系统以及获取操作系统的各种资源
- 处理操作系统发出的各种事件
- 创建并管理菜单栏
- 创建并管理应用程序窗口

Electron Helper（Renderer）该进程就是我们窗口所对应的渲染进程。

假设在任务管理器将该进程关闭掉，我们会发现窗口不再渲染任何的东西，但是应用还存在，窗口也还存在。

这里就需要说一下，实际上在 Electron 应用中，有一个窗口进程，由窗口进程来创建的窗口，之后才是渲染进程来渲染的页面。这也是为什么我们关闭了渲染进程，但是窗口还存在的原因。

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2023-12-14-034448.png" alt="image-20231214114447694" style="zoom:50%;" />

假设我们创建了多个窗口，那么会有多个窗口进程么？

多个窗口下仍然只有一个窗口进程，由这个窗口进程负责绘制多个窗口，不同的窗口里面会有不同的渲染进程来渲染页面。

如下图所示：

<img src="https://xiejie-typora.oss-cn-chengdu.aliyuncs.com/2023-12-14-035519.png" alt="image-20231214115519137" style="zoom:50%;" />

