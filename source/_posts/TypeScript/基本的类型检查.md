---
title: 3.TS-基本的类型检查
categories: TypeScript
tags: TypeScript
date: 2020-05-04 11:36:00
---

# 基本类型约束
> TS是一个可选的静态的类型系统

# 如何进行类型约束
仅需要在变量、函数的参数、函数的返回值位置加上XXX:类型
ts在很多场景中可以完成类型推导
any：表示任意类型，对该类型，ts不进行类型检查
> 小技巧，如何区分数字字符串和数字，关键看怎么读？
> 如果按照数字的方式朗读，则为数字；否则，为字符串

```bash
# 变量
let name:string;
name = '2131'
# 函数参数
function sum (a:number, b:number): number {
  return a + b;
}
let num:number = sum(12312, 3123)
# 变量推导出的类型和手动类型一致
# 中途不能修改变量类型
let name = '12312'; # 推导出string
name = 12321  # 错误
# number类型数组
let nums: number[];
nums = [2, 3, 4]
# let nums: Array<number> = [3, 4, 5]
```

# 源代码和编译结果的差异
编译结果中没有类型约束信息

## 基本类型
- number: 数字
- string: 字符串
- boolean：布尔
- 数组
- object: 对象
- null 和 undefined

null和undefined是其他类型的子类型，它们可以赋值给其他类型
通过添加**strictNullChecks: true**,可以获得更严格的空类型检查，null和undefined只能赋值给自身

## 其他常用类型
- 联合类型

配合类型保护进行判断
类型保护：当对某个变量进行类型判断之后，在判断的语句中便可以确定它的确切类型，typeof可以触发类型保护
```bash
let name: string | undefined;
if (typeof name === 'string') {
  # 类型保护
  name.substr
}
```

- void类型:通常用于约束函数的返回值，表示该函数没有任何返回

```bash
function printMenu(): void{
  console.log('1.登录')
  console.log('2.注册')
}
```

- never类型: 通常用来约束函数的返回值，表示该函数永远不可能结束

```bash
# 函数永远不会结束
function throwError(msg: string): never {
  throw new Error(msg);
}

function alwaysDoSometing(): never {
  while (true) {
    # ...
  }
}
```

- 字面量类型:使用一个值进行约束

```bash
# 变量只能去指定值
let a:"A" # a只能取值A
a = "A"
 # 结合联合类型，gender只能指定男或女
let gender: "男" | "女"
# 对user进行约束，赋值必须有字符串name，和数字age
let user: {
  name: string
  age: number
}
user = {
  name: '12312',
  age: 123
}
```

- 元祖类型（Tuple）:一个固定长度数组，并且数组中每一项的类型确定

```bash
let tu: [string, number];
tu = ['3', 4]
```

- any类型: any类型可以绕过类型检查，因此,any类型的数据可以赋值给任意类型

```bash
let data:any = 'ssdfas'
let num:number = data
```

## 类型别名
对已知的一些类型定义名称
```bash
type 类型名称 = 
```
举个栗子
```bash
type Gender = '男' | '女'
type User = {
  name: string,
  age: number,
  gender: Gender
}
let u: User
function getUser(g: Gender): User[] {
  return [{
    name: "12312",
    age: 123,
    gender: g
  }]
}
getUser('男')
```

## 函数的相关约束
函数重载：在函数实现之前，对函数调用的多种情况进行声明
```bash
/**
 * 得到a乘以b的结果
 * @param a 
 * @param b 
 */
function combine(a:number, b: number): number;
/**
 * 得到a和b拼接的结果
 * @param a 
 * @param b 
 */
function combine(a:string, b: string): string;
function combine(a: number | string, b: number | string): number | string {
  if (typeof a === 'number' && typeof b === 'number') {
    return a * b
  } 
  else if (typeof a === 'string' && typeof b === 'string') {
    return a + b
  }
  throw new Error('a和b必须时候是相同的类型');
}

const result = combine(3, 3);
```
可选参数：可以在某些参数名后加上问号，表示该参数可以不用传递。可选参数必须在参数列表的末尾
```bash
# c设置可选参数
function sum (a: number, b: number, c?: number) {
  if (c) {
    return a + b + c;
  } else {
    return a + b;
  }
}
# c设置默认参数
function sum1(a: number, b: number, c: number = 0) {

}
sum1(1, 2)
```

# 扑克牌小练习
1.目标：创建一副扑克牌（不包括大小王），打印该扑克牌
```bash
type Deck = NormalCard[]
type Color = "♠" | "♥" | "♣" | "♦"
type NormalCard = {
  color: Color,
  mark: number

}
function createDeck (): Deck {
  const deck: Deck = []
  for (let i = 1; i <= 13; i++) {
    deck.push({
      mark: i,
      color: "♠"
    })
    deck.push({
      mark: i,
      color: "♣"
    })
    deck.push({
      mark: i,
      color: "♥"
    })
    deck.push({
      mark: i,
      color: "♦"
    })
  }
  return deck
}

function printDeck (deck: Deck) {
  deck.forEach(item => {
    let str = item.color;
    if (item.mark <= 10) {
      str += item.mark
    }
    else if (item.mark === 11) {
      str += 'J'
    }
    else if (item.mark === 12) {
      str += "Q"
    }
    else{
      str += "K"
    }
  })
}
```